(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[920],{7197:function(e,t,s){Promise.resolve().then(s.bind(s,4140))},4140:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return r}});var n=s(7437),a=s(2265),i=s(9376);function r(){var e;let t=Number((0,i.useParams)().albumId),[s,r]=(0,a.useState)(null),[o,l]=(0,a.useState)(!0),[c,d]=(0,a.useState)(null);(0,a.useEffect)(()=>{!async function(){try{let e="http://clients.chasing.media:3700";if(!e)throw Error("Missing NEXT_PUBLIC_API_URL");let s=localStorage.getItem("admin_token");if(!s)throw Error("Missing admin token");let n=await fetch("".concat(e,"/admin/albums/").concat(t),{headers:{Authorization:"Bearer ".concat(s)}});if(!n.ok)throw Error("Failed to load album");let a=await n.json();r(a)}catch(e){d(e.message),console.error(e)}finally{l(!1)}}()},[t]);let u=async()=>{try{let e=localStorage.getItem("admin_token"),s=await fetch("".concat("http://clients.chasing.media:3700","/admin/session/create"),{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(e)},body:JSON.stringify({album_id:t})});if(!s.ok)throw Error("Failed to create session");let n=await s.json();alert("Magic Link Generated:\n".concat(n.magic_url))}catch(e){alert(e.message),console.error(e)}};return o?(0,n.jsx)("p",{children:"Loading albumâ€¦"}):c?(0,n.jsx)("p",{className:"text-red-600",children:c}):s?(0,n.jsxs)("div",{children:[(0,n.jsx)("h1",{className:"text-xl font-semibold mb-4",children:s.title}),(0,n.jsx)("button",{className:"bg-black text-white px-4 py-2 rounded",onClick:u,children:"Generate Magic Link"}),(0,n.jsx)("h2",{className:"text-lg font-semibold mt-6 mb-2",children:"Images"}),(0,n.jsx)("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:null===(e=s.images)||void 0===e?void 0:e.map(e=>(0,n.jsx)("div",{className:"border rounded overflow-hidden",children:(0,n.jsx)("img",{src:e.public_url,alt:"",className:"w-full h-auto"})},e.id))}),(0,n.jsx)("h2",{className:"text-lg font-semibold mt-6 mb-2",children:"Existing Sessions"}),(0,n.jsx)("div",{className:"space-y-2",children:s.sessions.map(e=>(0,n.jsxs)("div",{className:"bg-white p-3 rounded shadow",children:[(0,n.jsxs)("p",{children:[(0,n.jsx)("strong",{children:"Token:"})," ",e.token]}),(0,n.jsxs)("p",{children:[(0,n.jsx)("strong",{children:"Email:"})," ",e.email||"(none yet)"]}),(0,n.jsxs)("p",{children:[(0,n.jsx)("strong",{children:"Date:"})," ",e.created_at]})]},e.id))})]}):(0,n.jsx)("p",{children:"Album not found."})}},9376:function(e,t,s){"use strict";var n=s(5475);s.o(n,"useParams")&&s.d(t,{useParams:function(){return n.useParams}}),s.o(n,"useRouter")&&s.d(t,{useRouter:function(){return n.useRouter}})}},function(e){e.O(0,[971,117,744],function(){return e(e.s=7197)}),_N_E=e.O()}]);